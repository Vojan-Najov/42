
________________________________________________________________________________

	VIRTTUALBOX

________________________________________________________________________________

	Добро пожаловать в Oracle VM VirtualBox.

Oracle VM VirtualBox-это кроссплатформенное приложение для виртуализации. Что
это значит? Во-первых, он устанавливается на ваши существующие компьютеры на
базе Intel или AMD, независимо от того, работают ли они под управлением
операционных систем Windows, Mac OS X, Linux или Oracle Solaris (операционные
системы). Во-вторых, это расширяет возможности вашего существующего
компьютера, так что он может одновременно запускать несколько операционных
систем внутри нескольких виртуальных машин. Например, вы можете запускать
Windows и Linux на своем Mac, запускать Windows Server 2016 на своем сервере
Linux, запускать Linux на своем ПК с Windows и так Далее, все вместе с
существующими приложениями. Вы можете установить и запустить столько
виртуальных машин, сколько захотите. Единственными практическими ограничениями
являются дисковое пространство и память.

Oracle VM VirtualBox обманчиво прост, но в то же время очень мощен. Он может
работать везде, от небольших встроенных систем или компьютеров настольного
класса, вплоть до развертывания центров обработки данных и даже облачных сред.

________________________________________________________________________________

	1.1. Почему виртуализация полезна?

Методы и функции, предоставляемые Oracle VM VirtualBox, полезны в следующих
сценариях:

Запуск нескольких операционных систем одновременно. Oracle VM VirtualBox
позволяет запускать несколько ОС одновременно. Таким образом, вы можете
запускать программное обеспечение, написанное для одной ОС, на другой, например
программное обеспечение Windows на Linux или Mac, без необходимости перезагрузк
для его использования. Поскольку вы можете настроить, какие виды виртуального
оборудования должны быть представлены для каждой такой ОС, вы можете установить
старую ОС, такую как DOS или OS/2, даже если оборудование вашего реального
компьютера больше не поддерживается этой ОС.

Более простая установка программного обеспечения. Поставщики программного
обеспечения могут использовать виртуальные машины для доставки целых
конфигураций программного обеспечения. Например, установка полного решения
почтового сервера на реальной машине может быть утомительной задачей. С помощью
Oracle VM VirtualBox такая сложная настройка, часто называемая устройством,
может быть упакована в виртуальную машину. Установка и запуск почтового сервера
становится такой же простой, как импорт такого устройства в Oracle
VM VirtualBox.

Тестирование и аварийное восстановление. После установки виртуальную машину и
ее виртуальные жесткие диски можно рассматривать как контейнер, который можно
произвольно замораживать, пробуждать, копировать, создавать резервные копии и
перемещать между хостами.

Кроме того, с помощью другой функции Oracle VM VirtualBox, называемой
моментальными снимками, можно сохранить определенное состояние виртуальной
машины и при необходимости вернуться в это состояние. Таким образом, можно
свободно экспериментировать с вычислительной средой. Если что-то пойдет не
так, например, проблемы после установки программного обеспечения или заражения
гостя вирусом, вы можете легко переключиться на предыдущий снимок и избежать
необходимости частого резервного копирования и восстановления.

Можно создать любое количество моментальных снимков, что позволит вам
перемещаться вперед и назад во времени виртуальной машины. Вы можете удалять
моментальные снимки во время работы виртуальной машины, чтобы освободить место
на диске.

Консолидация инфраструктуры. Виртуализация может значительно снизить затраты
на оборудование и электроэнергию. Большую часть времени современные компьютеры
используют лишь малую часть своей потенциальной мощности и работают с низкими
средними нагрузками на систему. Таким образом, тратится много аппаратных
ресурсов, а также электроэнергии. Таким образом, вместо того, чтобы запускать
множество таких физических компьютеров, которые используются лишь частично,
можно упаковать множество виртуальных машин на несколько мощных хостов и
сбалансировать нагрузки между ними.

________________________________________________________________________________

	1.2. Некоторые термины

При работе с виртуализацией, а также для понимания следующих глав этой
документации, полезно ознакомиться с некоторыми важными терминами, особенно со
следующими терминами:

Хост-операционная система (хост-ОС). Это операционная система физического
компьютера, на котором был установлен Oracle VM VirtualBox. Существуют версии
Oracle VM VirtualBox для хостов Windows, Mac OS X, Linux и Oracle Solaris. 

В большинстве случаев в этом руководстве рассматриваются все версии Oracle VM
VirtualBox вместе. Могут существовать различия, зависящие от конкретной
платформы, на которые мы будем указывать в соответствующих случаях.

Гостевая операционная система (гостевая ОС). Это операционная система, которая
работает внутри виртуальной машины. Теоретически Oracle VM VirtualBox может
запускать любые ОС x86, такие как DOS, Windows, OS/2, FreeBSD и OpenBSD. Но для
достижения почти собственной производительности гостевого кода на вашей машине
нам пришлось пройти множество оптимизаций, специфичных для определенных
операционных систем. Поэтому, хотя ваша любимая ОС может работать в качестве
гостевой, мы официально поддерживаем и оптимизируем некоторые из них, включая
наиболее распространенные операционные системы.

Виртуальная машина (ВМ). Это специальная среда, которую Oracle VM VirtualBox
создает для вашей гостевой ОС во время ее работы. Другими словами, вы
запускаете гостевую ОС в виртуальной машине. Обычно виртуальная машина
отображается в виде окна на рабочем столе вашего компьютера. В зависимости от
того, какой из различных интерфейсов Oracle VM VirtualBox вы используете,
виртуальная машина может отображаться в полноэкранном режиме или удаленно на
другом компьютере.

Внутренне Oracle VM VirtualBox рассматривает виртуальную машину как набор
параметров, определяющих ее поведение. Некоторые параметры описывают настройки
оборудования, такие как объем памяти и количество назначенных процессоров.
Другие параметры описывают информацию о состоянии, например, запущена ли
виртуальная машина или сохранена.

Вы можете просмотреть эти параметры виртуальной машины в окне
VirtualBox Manager, в диалоговом окне настроек и выполнив команду VBoxManage. 

Дополнения для Гостей. Это относится к специальным программным пакетам, которые
поставляются с Oracle VM VirtualBox, но предназначены для установки внутри
виртуальной машины для повышения производительности гостевой ОС и добавления
дополнительных функций.

________________________________________________________________________________

	1.3. Обзор функций

Ниже приводится краткое описание основных функций Oracle VM VirtualBox:

Портативность. Oracle VM VirtualBox работает на большом количестве 64-разрядных
операционных систем хоста. 

Oracle VM VirtualBox-это так называемый размещенный гипервизор, иногда
называемый гипервизором типа 2. В то время как гипервизор голого металла или
типа 1 будет работать непосредственно на оборудовании, Oracle VM VirtualBox
требует установки существующей операционной системы. Таким образом, он может
работать вместе с существующими приложениями на этом хосте.

В очень большой степени Oracle VM VirtualBox функционально идентичен на всех
хост-платформах, и используются одни и те же форматы файлов и изображений. Это
позволяет запускать виртуальные машины, созданные на одном хосте, на другом
хосте с другой операционной системой хоста. Например, вы можете создать
виртуальную машину в Windows, а затем запустить ее под управлением Linux.

Кроме того, виртуальные машины можно легко импортировать и экспортировать с
использованием открытого формата виртуализации (OVF), отраслевого стандарта,
созданного для этой цели. Вы даже можете импортировать OVFs, созданные с
помощью другого программного обеспечения для виртуализации. 

Для пользователей облачной инфраструктуры Oracle функциональность
распространяется на экспорт и импорт виртуальных машин в облако и из него.
Это упрощает разработку приложений и развертывание в производственной среде. 

Гостевые дополнения: общие папки, бесшовные окна, 3D-виртуализация. Гостевые
дополнения Oracle VM VirtualBox-это пакеты программного обеспечения, которые
могут быть установлены внутри поддерживаемых гостевых систем для повышения их
производительности и обеспечения дополнительной интеграции и связи с
хост-системой. После установки гостевых дополнений виртуальная машина будет
поддерживать автоматическую настройку разрешения видео, бесшовные окна,
ускоренную 3D-графику и многое другое. См. Главу 4, Дополнения для гостей.

В частности, гостевые дополнения предусматривают общие папки, которые позволяют
вам получать доступ к файлам в хост-системе с гостевой машины. См. Раздел
4.3, “Общие папки”.

Отличная аппаратная поддержка. Среди других функций Oracle VM VirtualBox
поддерживает следующие:

Гостевая многопроцессорная обработка (SMP). Oracle VM VirtualBox может
предоставить до 32 виртуальных процессоров для каждой виртуальной машины,
независимо от того, сколько ядер процессора физически присутствует на вашем
хосте.

Поддержка USB-устройств. Oracle VM VirtualBox реализует виртуальный
USB-контроллер и позволяет подключать произвольные USB-устройства к
виртуальным машинам без необходимости установки драйверов для конкретных
устройств на хосте. Поддержка USB не ограничивается определенными категориями
устройств. См. Раздел 3.11.1, “Настройки USB”.

Совместимость с оборудованием. Oracle VM VirtualBox виртуализирует широкий
спектр виртуальных устройств, в том числе множество устройств, которые обычно
предоставляются другими платформами виртуализации. Это включает контроллеры
жестких дисков IDE, SCSI и SATA, несколько виртуальных сетевых карт и звуковых
карт, виртуальные последовательные и параллельные порты и усовершенствованный
программируемый контроллер прерываний ввода-вывода (APIC ввода-вывода),
который используется во многих компьютерных системах. Это позволяет легко
клонировать образы дисков с реальных машин и импортировать сторонние
виртуальные машины в Oracle VM VirtualBox.

Полная поддержка ACPI. Интерфейс расширенной конфигурации и питания (ACPI)
полностью поддерживается Oracle VM VirtualBox. Это позволяет легко клонировать
образы дисков с реальных машин или виртуальных машин сторонних производителей
в Oracle VM VirtualBox. Благодаря уникальной поддержке статуса питания ACPI
Oracle VM VirtualBox может даже сообщать гостевым операционным системам,
поддерживающим ACPI, о состоянии питания хоста. Для мобильных систем, работающи
от аккумулятора, гость, таким образом, может включить энергосбережение и
уведомить пользователя об оставшейся мощности, например, в полноэкранном режиме.

Разрешение нескольких экранов. Виртуальные машины Oracle VM VirtualBox
поддерживают разрешение экрана во много раз больше, чем у физического экрана,
что позволяет размещать их на большом количестве экранов, подключенных к
хост-системе.

Встроенная поддержка iSCSI. Эта уникальная функция позволяет подключать
виртуальную машину непосредственно к серверу хранения iSCSI, не проходя через
хост-систему. Виртуальная машина напрямую обращается к целевому объекту iSCSI
без дополнительных затрат, необходимых для виртуализации жестких дисков в
файлах-контейнерах. См. Раздел 5.10, “Серверы iSCSI”.

Загрузка по сети PXE. Интегрированные виртуальные сетевые карты Oracle VM
VirtualBox полностью поддерживают удаленную загрузку с использованием среды
выполнения предварительной загрузки (PXE).

Разветвленные снимки нескольких поколений. Oracle VM VirtualBox может
сохранять произвольные моментальные снимки состояния виртуальной машины. Вы
можете вернуться назад во времени и вернуть виртуальную машину к любому такому
снимку и запустить оттуда альтернативную конфигурацию виртуальной машины,
фактически создав целое дерево снимков. См. Раздел 1.10, “Моментальные снимки”.
Вы можете создавать и удалять моментальные снимки во время работы виртуальной
машины.

Группы виртуальных машин. Oracle VM VirtualBox предоставляет функцию групп,
которая позволяет пользователю организовывать виртуальные машины и управлять
ими как коллективно, так и индивидуально. В дополнение к основным группам,
любая виртуальная машина также может входить в несколько групп, а группы могут
быть вложены в иерархию. Это означает, что у вас могут быть группы групп. В
целом, операции, которые могут выполняться над группами, такие же, как и те,
которые могут быть применены к отдельным виртуальным машинам: Запуск, Пауза,
Сброс, Закрытие (Сохранение состояния, Завершение работы, Отключение питания),
Удаление сохраненного состояния, Отображение в файловой системе, Сортировка.

Чистая архитектура и беспрецедентная модульность. Oracle VM VirtualBox имеет
чрезвычайно модульную конструкцию с четко определенными внутренними
интерфейсами программирования и четким разделением клиентского и серверного
кода. Это позволяет легко управлять им сразу с нескольких интерфейсов.
Например, вы можете запустить виртуальную машину, просто нажав кнопку в
графическом пользовательском интерфейсе Oracle VM VirtualBox, а затем
управлять этой машиной из командной строки или даже удаленно.
См. Раздел 1.17, “Альтернативные интерфейсы”.

Благодаря своей модульной архитектуре Oracle VM VirtualBox также может
предоставить полную функциональность и возможность настройки с помощью
комплексного пакета разработки программного обеспечения (SDK), который
обеспечивает интеграцию Oracle VM VirtualBox с другими программными системами.
См. Главу 11, Программные интерфейсы Oracle VM VirtualBox.

Удаленный дисплей машины. Расширение VirtualBox для удаленного рабочего стола
(VRDE) обеспечивает высокопроизводительный удаленный доступ к любой работающей
виртуальной машине. Это расширение поддерживает протокол удаленного рабочего
стола (RDP), изначально встроенный в Microsoft Windows, со специальными
дополнениями для полной поддержки USB клиента.

VRDE не полагается на сервер RDP, встроенный в Microsoft Windows. Вместо этого
VRDE подключается непосредственно к уровню виртуализации. В результате он
работает с гостевыми операционными системами, отличными от Windows, даже в
текстовом режиме, и также не требует поддержки приложений на виртуальной машине
VRDE подробно описан в разделе 7.1 “Удаленный дисплей (поддержка VRDP)”.

В дополнение к этой специальной емкости Oracle VM VirtualBox предлагает вам
более уникальные функции:

Расширяемая аутентификация по протоколу RDP. Oracle VM VirtualBox уже
поддерживает Winlogon в Windows и PAM в Linux для аутентификации по протоколу
RDP. Кроме того, он включает в себя простой в использовании SDK, который
позволяет создавать произвольные интерфейсы для других методов аутентификации.
См. Раздел 7.1.5, “Аутентификация по протоколу RDP”.

USB через RDP. Используя поддержку виртуального канала RDP, Oracle VM
VirtualBox также позволяет подключать произвольные USB-устройства локально к
виртуальной машине, которая работает удаленно на сервере Oracle VM VirtualBox
RDP. См. Раздел 7.1.4, “Удаленный USB”.

________________________________________________________________________________

	1.4. Поддерживаемые Операционные Системы Хоста

В настоящее время Oracle VM VirtualBox работает на следующих операционных
системах хостов:

Windows hosts (64-bit):
	Windows 8.1
	Windows 10 RTM (1507 / 2015 LTSB) build 10240
	Windows 10 Anniversary Update (1607 / 2016 LTSB) build 14393
	Windows 10 Fall Creators Update (1709) build 16299
	Windows 10 April 2018 Update (1803) build 17134
	Windows 10 October 2018 Update (1809 / 2019 LTSC) build 17763
	Windows 10 May 2019 Update (19H1 / 1903) build 18362
	Windows 10 November 2019 Update (19H2 / 1909) build 18363
	Windows Server 2012
	Windows Server 2012 R2
	Windows Server 2016
	Windows Server 2019

Mac OS X hosts (64-bit):
	10.13 (High Sierra)
	10.14 (Mojave)
	10.15 (Catalina)

Intel hardware is required. See also Chapter 14, Known Limitations.

Linux hosts (64-bit). Includes the following:
	Ubuntu 18.04 LTS, 19.03 and 19.10
	Debian GNU/Linux 9 ("Stretch") and 10 ("Buster")
	Oracle Linux 6, 7 and 8
	CentOS/Red Hat Enterprise Linux 6, 7 and 8
	Fedora 30 and 31
	Gentoo Linux
	SUSE Linux Enterprise server 12 and 15
	openSUSE Leap 15.1

Oracle Solaris hosts (64-bit only).
	Oracle Solaris 11

________________________________________________________________________________

	1.5. Установка Oracle VM VirtualBox и пакетов расширений

Oracle VM VirtualBox поставляется в различных пакетах, и установка зависит от
операционной системы вашего хоста. Если вы уже устанавливали программное
обеспечение раньше, установка должна быть простой. На каждой хост-платформе
Oracle VM VirtualBox использует наиболее распространенный и простой в
использовании метод установки. Если у вас возникли проблемы или у вас есть
особые требования, см. Главу 2, Сведения об установке для получения подробной
информации о различных методах установки.

Oracle VM VirtualBox разделен на следующие компоненты:

Базовый пакет. Базовый пакет состоит из всех компонентов с открытым исходным
кодом и лицензирован под лицензией GNU General Public License V2.

Пакеты расширений. Можно загрузить дополнительные пакеты расширений, которые
расширяют функциональность базового пакета Oracle VM VirtualBox.
В настоящее время Oracle предоставляет единый пакет расширений, доступный по
адресу: http://www.virtualbox.org. Пакет расширений предоставляет следующие
дополнительные функциональные возможности:
	Виртуальное устройство USB 2.0 (EHCI). См. Раздел 3.11.1, “Настройки USB”.
	Виртуальное устройство USB 3.0 (xHCI). См. Раздел 3.11.1, “Настройки USB”.
	Поддержка протокола удаленного рабочего стола VirtualBox (VRDP).
См. Раздел 7.1, “Удаленный дисплей (поддержка VRDP)”.
	Проведите веб-камеру через хост. См. Раздел 9.5, “Прохождение веб-Камеры”.
	Загрузочный ПЗУ Intel PXE.
	Шифрование образа диска с помощью алгоритма AES.
См. Раздел 9.28, “Шифрование образов дисков”.
	Функции облачной интеграции. См.
Раздел 1.14, “Импорт и экспорт виртуальных машин”.

Пакеты расширений Oracle VM VirtualBox имеют расширение имени файла
.vbox-extpack. Чтобы установить расширение, просто дважды щелкните файл
пакета, и откроется окно Диспетчера сетевых операций, в котором вы выполните
необходимые действия.

Чтобы просмотреть установленные в данный момент пакеты расширений, запустите
диспетчер VirtualBox, как показано в разделе 1.6 " Запуск Oracle VM VirtualBox”
В меню Файл выберите пункт Настройки. В открывшемся окне перейдите в категорию
Расширения. Это показывает вам установленные в данный момент расширения и
позволяет удалить пакет или добавить новый пакет.

Кроме того, вы можете использовать командную строку VBoxManage.
См. Раздел 8.41, “Пакет расширения VBoxManage”.

________________________________________________________________________________
	
	1.6. Запуск виртуальной машины Oracle VirtualBox

После установки вы можете запустить Oracle VM VirtualBox следующим образом:

На хосте Windows в меню Программы выберите пункт в группе VirtualBox. На
некоторых платформах Windows вы также можете ввести VirtualBox в поле поиска
меню "Пуск".

На хосте Mac OS X в Finder дважды щелкните элемент VirtualBox в папке
Приложения. Возможно, вы захотите перетащить этот элемент на свою док-станцию.

На хосте Linux или Oracle Solaris, в зависимости от среды рабочего стола,
элемент Oracle VM VirtualBox может быть помещен в группу "Система" или
"Системные инструменты" меню "Приложения". Кроме того, вы можете ввести
VirtualBox в окне терминала.

На левой панели позже появится список всех ваших виртуальных машин.
Поскольку вы еще не создали никаких виртуальных машин, этот список пуст.
Кнопка "Инструменты" предоставляет доступ к пользовательским инструментам,
таким как диспетчер виртуальных носителей.

На панели справа отображаются свойства выбранной в данный момент виртуальной
машины. Поскольку у вас еще нет компьютеров, на панели отображается
приветственное сообщение.

Кнопки на правой панели используются для создания виртуальных машин и работы
с ними.

________________________________________________________________________________

	1.7. Создание Вашей Первой Виртуальной Машины

Нажмите кнопку Создать в окне менеджера VirtualBox. Отобразится мастер,
который поможет вам настроить новую виртуальную машину (ВМ).

Создание новой виртуальной машины: Имя и операционная система
На следующих страницах мастер запросит у вас минимум информации, необходимой
для создания виртуальной машины, в частности:

	1. Имя выбранной вами виртуальной машины отображается в списке машин окна
VirtualBox Manager и также используется для файлов виртуальной машины на диске.
Обязательно назначьте каждой виртуальной машине информативное имя, описывающее
операционную систему и программное обеспечение, работающие на виртуальной
машине. Например, Windows 10 с Visio.

	2. Папка "Машина" - это место, где на вашем компьютере хранятся
виртуальные машины. Отображается расположение папки по умолчанию.

	3. В поле Тип операционной системы выберите операционную систему, которую
вы хотите установить. Поддерживаемые операционные системы сгруппированы. Если
вы хотите установить что-то очень необычное, чего нет в списке, выберите Другое
В зависимости от вашего выбора Oracle VM VirtualBox включит или отключит
определенные параметры виртуальной машины, которые могут потребоваться вашей
гостевой операционной системе. Это особенно важно для 64-разрядных гостей.
См. Раздел 3.1.2, “64-разрядные гости”. Поэтому рекомендуется всегда
устанавливать его на правильное значение.

	4. На следующей странице выберите память (ОЗУ), которую Oracle VM
VirtualBox должен выделять при каждом запуске виртуальной машины. Указанный
здесь объем памяти будет удален с вашей хост-машины и представлен гостевой
операционной системе, которая сообщит об этом размере как об установленной
оперативной памяти виртуального компьютера.

	Осторожно
Тщательно выберите этот параметр. Память, которую вы предоставляете виртуальной
машине, будет недоступна для операционной системы вашего хоста во время работы
виртуальной машины, поэтому не указывайте больше, чем вы можете выделить.
Например, если на вашей хост-машине 4 ГБ оперативной памяти и вы вводите
2048 МБ в качестве объема оперативной памяти для конкретной виртуальной машины,
у вас останется только 2 ГБ для всего остального программного обеспечения на
вашем хосте во время работы виртуальной машины. Если вы запустите две
виртуальные машины одновременно, для второй виртуальной машины будет выделено
еще больше памяти, которая может даже не запуститься, если эта память
недоступна.
С другой стороны, вы должны указать столько, сколько потребуется вашей
гостевой ОС и вашим приложениям для правильной работы. Для установки и
загрузки гостевой ОС может потребоваться не менее 1 или 2 ГБ памяти. Для
достижения наилучшей производительности может потребоваться больше памяти, чем
требуется.

Всегда убедитесь, что в основной операционной системе осталось достаточно
оперативной памяти. Если останется недостаточно оперативной памяти, система
может чрезмерно подкачать память на жесткий диск, что фактически приведет к
остановке хост-системы.

Как и в случае с другими настройками, вы можете изменить этот параметр позже,
после создания виртуальной машины.

	5. Затем вы должны указать виртуальный жесткий диск для своей виртуальной
машины.

Существует множество потенциально сложных способов предоставления виртуальной
машине Oracle VM VirtualBox места на жестком диске (см. главу 5 "Виртуальное
хранилище"), но наиболее распространенным способом является использование
большого файла образа на физическом жестком диске, содержимое которого Oracle
VM VirtualBox представляет виртуальной машине так, как если бы это был полный
жесткий диск. Затем этот файл представляет собой весь жесткий диск, поэтому вы
даже можете скопировать его на другой хост и использовать с другой установкой
Oracle VM VirtualBox.

На этом экране у вас есть следующие опции:
	Чтобы создать новый пустой виртуальный жесткий диск, нажмите кнопку Создать.
	Вы можете выбрать существующий файл образа диска.
В раскрывающемся списке, представленном в окне, перечислены все образы дисков,
которые в данный момент запоминаются Oracle VM VirtualBox. Эти образы дисков в
настоящее время подключены к виртуальной машине или были подключены к
виртуальной машине.
Кроме того, нажмите на значок небольшой папки рядом с раскрывающимся списком.
В открывшемся диалоговом окне "Файл" вы можете нажать "Добавить", чтобы
выбрать любой файл образа диска на главном диске.

Если вы впервые используете Oracle VM VirtualBox, вам потребуется создать
новый образ диска. Нажмите кнопку Создать.
Откроется другое окно, мастер создания виртуального жесткого диска. Этот мастер
поможет вам создать новый файл образа диска в папке новой виртуальной машины.

Oracle VM VirtualBox поддерживает следующие типы файлов изображений:

	Динамически выделяемый файл увеличивается в размере только тогда, когда
гость фактически хранит данные на своем виртуальном жестком диске. Поэтому
этот файл изначально невелик. По мере заполнения диска данными файл
увеличивается до указанного размера.
	Файл фиксированного размера немедленно занимает указанный файл, даже если
фактически используется только часть этого виртуального жесткого диска. Занимая
гораздо больше места, файл фиксированного размера требует меньше накладных
расходов и, следовательно, немного быстрее, чем динамически выделяемый файл.

Дополнительные сведения о различиях см. в разделе 5.2, “Файлы образов дисков
(VDI, VMDK, VHD, HDD)”.

Чтобы предотвратить заполнение вашего физического жесткого диска (ОС хоста),
Oracle VM VirtualBox ограничивает размер файла образа. Но файл изображения
должен быть достаточно большим, чтобы вместить содержимое гостевой ОС и
приложений, которые вы хотите установить. Для гостя Windows или Linux вам,
вероятно, потребуется несколько гигабайт для любого серьезного использования.
Ограничение размера файла изображения может быть изменено позже,
см. Раздел 8.22, “VBoxManage modifymedium”.

После выбора или создания файла изображения нажмите кнопку Далее, чтобы
перейти на следующую страницу.

	6. Нажмите кнопку Создать, чтобы создать новую виртуальную машину.
Виртуальная машина отображается в списке в левой части окна менеджера
VirtualBox с именем, которое вы ввели изначально.

Примечание
После ознакомления с использованием мастеров рассмотрите возможность
использования режима эксперта, доступного в некоторых мастерах. Там, где это
доступно, это можно выбрать с помощью кнопки и ускорить процесс использования
мастеров.

________________________________________________________________________________

	1.8. Запуск Вашей Виртуальной Машины

Чтобы запустить виртуальную машину, у вас есть несколько вариантов:

	Дважды щелкните запись виртуальной машины в списке в окне менеджера
VirtualBox.
	Выберите запись виртуальной машины в списке в окне VirtualBox Manager и
нажмите кнопку Пуск в верхней части окна.
	Перейдите в папку виртуальных машин VirtualBox в домашнем каталоге
пользователя вашей системы. Найдите подкаталог машины, которую вы хотите
запустить, и дважды щелкните файл настроек машины. Этот файл имеет расширение
файла .vbox.

При запуске виртуальной машины откроется новое окно, и выбранная вами
виртуальная машина загрузится. В окне отображается все, что обычно отображается
на мониторе виртуальной системы. 

В общем, вы можете использовать виртуальную машину так же, как использовали бы
реальный компьютер. Однако есть несколько моментов, о которых стоит упомянуть.

	1.8.1. Запуск новой виртуальной машины в первый раз

При первом запуске виртуальной машины отображается Мастер первого запуска.
Этот мастер поможет вам выбрать установочный носитель. Поскольку виртуальна
машина создается пустой, в противном случае она вела бы себя так же, как
настоящий компьютер без установленной операционной системы. Он ничего не
сделает и отобразит сообщение об ошибке о том, что загрузочная ОС не найдена.

По этой причине мастер поможет вам выбрать носитель для установки операционной
системы.
	Если у вас есть физический компакт-диск или DVD-носитель, с которого вы
хотите установить гостевую ОС, например установочный компакт-диск или DVD-диск
Windows, вставьте носитель в дисковод CD или DVD вашего хоста.
В раскрывающемся списке установочных носителей мастера выберите диск хоста с
правильной буквой диска. В случае хоста Linux выберите файл устройства. Это
позволит вашей виртуальной машине получить доступ к носителю на вашем
хост-дискe, и вы сможете приступить к установке оттуда.
	Если вы загрузили установочный носитель из Интернета в виде файла образа
ISO, например, с дистрибутивом Linux, вы обычно записываете этот файл на
пустой CD или DVD и действуете, как описано выше. Однако с помощью Oracle
VM VirtualBox вы можете пропустить этот шаг и смонтировать ISO-файл напрямую.
Oracle VM VirtualBox затем представит этот файл в виде диска CD или DVD-ROM
виртуальной машине, как это происходит с образами виртуальных жестких дисков.
В этом случае раскрывающийся список мастера содержит список установочных
носителей, которые ранее использовались с Oracle VM VirtualBox.
Если вашего носителя нет в списке, особенно если вы впервые используете Oracle
VM VirtualBox, щелкните значок небольшой папки рядом с раскрывающимся списком,
чтобы открыть стандартное диалоговое окно с файлами. Здесь вы можете выбрать
файл образа на своих дисках хоста.

После завершения выбора в мастере вы сможете установить свою операционную
систему.

	1.8.2. Захват и освобождение клавиатуры и мыши

Oracle VM VirtualBox предоставляет виртуальное USB-планшетное устройство для
новых виртуальных машин, с помощью которого события мыши передаются в гостевую
ОС. Если вы используете современную гостевую ОС, которая может работать с
такими устройствами, поддержка мыши может работать "из коробки" без захвата
мыши, как описано ниже. См. Раздел 3.5.1, “Вкладка "Материнская плата".

В противном случае, если виртуальная машина обнаруживает только стандартные
устройства мыши и клавиатуры PS/2, поскольку операционная система виртуальной
машины не знает, что она не работает на реальном компьютере, она ожидает, что
будет иметь исключительный контроль над вашей клавиатурой и мышью. Но если вы
не используете виртуальную машину в полноэкранном режиме, вашей виртуальной
машине необходимо совместно использовать клавиатуру и мышь с другими
приложениями и, возможно, другими виртуальными машинами на вашем хосте.

После установки гостевой ОС и до установки гостевых дополнений, описанных ниже,
либо ваша виртуальная машина, либо остальная часть вашего компьютера могут
"владеть" клавиатурой и мышью. Оба не могут владеть клавиатурой и мышью
одновременно. Вы увидите второй указатель мыши, который всегда ограничен
пределами окна виртуальной машины. Вы активируете виртуальную машину, щелкнув
внутри нее.

Чтобы вернуть право собственности на клавиатуру и мышь вашей основной
операционной системе, Oracle VM VirtualBox резервирует специальный ключ на
вашей клавиатуре: ключ хоста. По умолчанию это правая клавиша Ctrl на вашей
клавиатуре. На хосте Mac ключом хоста по умолчанию является левая командная
клавиша. Вы можете изменить это значение по умолчанию в глобальных настройках
Oracle VM VirtualBox. См. Раздел 1.16, “Глобальные настройки”. Текущая
настройка ключа хоста всегда отображается в правом нижнем углу окна
виртуальной машины.

Это означает следующее:

	Ваша клавиатура принадлежит виртуальной машине, если окно виртуальной машин
на рабочем столе хоста имеет фокус клавиатуры. Если в гостевой ОС открыто
много окон, используется окно, на котором сосредоточена ваша виртуальная
машина. Это означает, что если вы хотите ввести текст в виртуальную машину,
сначала нажмите на строку заголовка окна виртуальной машины.

Чтобы освободить владение клавиатурой, нажмите клавишу хоста. Как объяснялось
выше, обычно это правая клавиша Ctrl.

Обратите внимание, что, хотя виртуальная машина владеет клавиатурой, некоторые
последовательности клавиш, такие как Alt+Tab, больше не будут видны хосту, а
вместо этого перейдут к гостю. После нажатия клавиши хоста для повторного
включения клавиатуры хоста все нажатия клавиш будут проходить через хост
снова, так что такие последовательности, как Alt+Tab, больше не будут
достигаться гостем. По техническим причинам виртуальная машина может не
получить весь ввод с клавиатуры, даже если она владеет клавиатурой. Примерами
этого являются последовательность Ctrl+Alt+Del на узлах Windows или отдельные
клавиши, захваченные другими приложениями на узлах X11, такими как функция
указателя местоположения рабочего стола GNOME.

	Ваша мышь принадлежит виртуальной машине только после того, как вы
щелкнули в окне виртуальной машины. Указатель мыши хоста исчезнет, и ваша мышь
будет управлять указателем гостя вместо обычного указателя мыши.

Обратите внимание, что владение мышью не зависит от владения клавиатурой. Даже
после того, как вы нажали на строку заголовка, чтобы иметь возможность вводить
текст в окно виртуальной машины, ваша мышь еще не обязательно принадлежит
виртуальной машине.

Чтобы освободить виртуальную машину от владения мышью, нажмите клавишу хоста.

Поскольку такое поведение неудобно, Oracle VM VirtualBox предоставляет набор
инструментов и драйверов устройств для гостевых систем, называемых гостевыми
дополнениями Oracle VM VirtualBox. Эти инструменты делают операции виртуальной
машины с клавиатурой и мышью намного более плавными. Самое главное, что
дополнения для гостей подавляют второй указатель мыши "гость" и заставляют
указатель мыши вашего хоста работать непосредственно в госте.
См. Главу 4, Дополнения для гостей.

	1.8.3. Ввод Специальных Символов

Некоторые операционные системы ожидают, что определенные комбинации клавиш
инициируют определенные процедуры. Комбинации клавиш, которые вы вводите в
виртуальную машину, могут быть нацелены на ОС хоста, программное обеспечение
Oracle VM VirtualBox или гостевую ОС. Получатель этих нажатий зависит от ряда
факторов, включая саму комбинацию клавиш.

Операционные системы хоста резервируют определенные комбинации клавиш для себя.
Например, вы не можете использовать комбинацию Ctrl+Alt+Delete для
перезагрузки гостевой операционной системы на виртуальной машине, поскольку
эта комбинация клавиш обычно жестко подключена к основной операционной системе.
Таким образом, даже несмотря на то, что операционные системы Windows и Linux
перехватывают эту комбинацию клавиш, перезагрузится только хост-ОС.

На хостах Linux и Oracle Solaris, использующих систему X Window, комбинация
клавиш Ctrl+Alt+Backspace обычно сбрасывает X-сервер и перезапускает весь
графический пользовательский интерфейс. Поскольку X-сервер перехватывает эту
комбинацию, нажатие на нее обычно перезапускает графический пользовательский
интерфейс хоста и в процессе убивает все запущенные программы, включая Oracle
VM VirtualBox.

На хостах Linux, поддерживающих виртуальные терминалы, комбинация клавиш
Ctrl+Alt+Fx, где Fx является одной из функциональных клавиш от F1 до F12,
обычно позволяет переключаться между виртуальными терминалами. Как и в случае
с Ctrl+Alt+Delete, эти комбинации перехватываются операционной системой хоста
и, следовательно, всегда переключают терминалы на хосте.

Если вместо этого вы хотите отправить эти комбинации клавиш в гостевую ОС
виртуальной машины, вам нужно будет использовать один из следующих методов:

Используйте пункты меню Ввод, клавиатура окна виртуальной машины. Это меню
включает в себя настройки Вставить Ctrl+Alt+Удалить и Вставить Ctrl+Alt+Пробел.
Однако последний параметр влияет только на гостей Linux или гостей Oracle
Solaris.
Это меню также включает в себя опцию для вставки комбинации клавиш хоста.
Используйте специальные комбинации клавиш с ключом хоста, который обычно
является правильным управляющим ключом. Oracle VM VirtualBox затем преобразует
следующие комбинации клавиш для виртуальной машины:
	Клавиша хоста + Del отправляет Ctrl+Alt+Del для перезагрузки гостевой ОС.
	Клавиша хоста + Backspace отправляет Ctrl+Alt+Backspace для перезапуска
графического пользовательского интерфейса гостя Linux или Oracle Solaris.
	Клавиша хоста + Функциональная клавиша. Например, используйте эту
комбинацию клавиш для имитации Ctrl+Alt+Fx для переключения между виртуальными
терминалами в гостевой системе Linux.

Для некоторых других комбинаций клавиш, таких как Alt+Tab для переключения
между открытыми окнами, Oracle VM VirtualBox позволяет настроить, будут ли эти
комбинации влиять на хост или гостя, если в данный момент виртуальная машина
находится в центре внимания. Это глобальная настройка для всех виртуальных
машин, и ее можно найти в разделе Файл, Настройки, Ввод.

Для ввода комбинаций клавиш в гостевой системе можно использовать программную
клавиатуру. См. Раздел 1.18, “Программная клавиатура”.

	1.8.4. Замена Съемных Носителей

Во время работы виртуальной машины вы можете изменить съемный носитель в меню
Устройства окна виртуальной машины. Здесь вы можете подробно выбрать, что
Oracle VM VirtualBox представляет вашей виртуальной машине в виде CD, DVD или
дисковода.

Настройки такие же, как и для виртуальной машины, доступные в диалоговом окне
настроек главного окна Oracle VM VirtualBox. Но поскольку диалоговое окно
настроек отключено, пока виртуальная машина находится в запущенном или
сохраненном состоянии, меню "Устройства" избавляет вас от необходимости
выключать и перезапускать виртуальную машину каждый раз, когда вы хотите
сменить носитель.

Используя меню Устройства, вы можете подключить хост-накопитель к гостевому
или выбрать образ дискеты или DVD, как описано в разделе
3.7" Настройки хранилища”.

Меню "Устройства" также включает опцию создания виртуального ISO (VISO) из
выбранных файлов на хосте.

	1.8.5. Изменение размера окна машины

Вы можете изменить размер окна виртуальной машины во время ее работы. Когда вы
это сделаете, окно масштабируется следующим образом:

Если у вас включен режим масштабирования, то экран виртуальной машины будет
масштабирован до размера окна. Это может быть полезно, если у вас работает
много машин и вы хотите взглянуть на одну из них, пока она работает в фоновом
режиме. В качестве альтернативы может быть полезно увеличить окно, если экран
вывода виртуальной машины очень мал, например, из-за того, что вы используете
в нем старую ОС.

Чтобы включить масштабированный режим, нажмите клавишу хоста + C или выберите
Масштабированный режим в меню Вид в окне виртуальной машины. Чтобы выйти из
режима масштабирования, снова нажмите клавишу Host + C.

Соотношение сторон гостевого экрана сохраняется при изменении размера окна.
Чтобы игнорировать соотношение сторон, нажмите Shift во время операции
изменения размера.

Дополнительные замечания см. в главе 14 "Известные ограничения".

Если у вас установлены гостевые дополнения и они поддерживают автоматическое
изменение размера, гостевые дополнения автоматически изменят разрешение экрана
гостевой ОС. Например, если вы используете гостевую систему Windows с
разрешением 1024х768 пикселей, а затем измените размер окна виртуальной машины,
чтобы оно стало на 100 пикселей шире, гостевые дополнения изменят разрешение
дисплея Windows на 1124х768.

См. Главу 4, Дополнения для гостей.

В противном случае, если окно больше экрана виртуальной машины, экран будет
центрирован. Если он меньше, то полосы прокрутки будут добавлены в окно машины.

	1.8.6. Сохранение состояния машины

Когда вы нажимаете кнопку Закрыть окна виртуальной машины в правом верхнем
углу окна, точно так же, как вы закрываете любое другое окно в своей системе,
Oracle VM VirtualBox спрашивает вас, хотите ли вы сохранить или выключить
виртуальную машину. В качестве ярлыка вы также можете нажать клавишу хоста + Q.

Разница между этими тремя вариантами имеет решающее значение. Они означают
следующее:
	Сохранение состояния машины: С помощью этой опции Oracle VM VirtualBox
замораживает виртуальную машину, полностью сохраняя ее состояние на локальном
диске.
Когда вы позже снова запустите виртуальную машину, вы обнаружите, что
виртуальная машина продолжается точно с того места, где она была остановлена.
Все ваши программы по-прежнему будут открыты, и ваш компьютер возобновит работу
Таким образом, сохранение состояния виртуальной машины в некотором роде похоже
на приостановку работы портативного компьютера, закрыв его крышку.
	Отправьте сигнал об отключении. Это отправит сигнал выключения ACPI на
виртуальную машину, который будет иметь тот же эффект, как если бы вы нажали
кнопку питания на реальном компьютере. Это должно запустить надлежащий
механизм выключения из виртуальной машины.
	Выключите компьютер: С помощью этой опции Oracle VM VirtualBox также
прекращает запуск виртуальной машины, но без сохранения ее состояния.
Предупреждение
Это эквивалентно выдергиванию вилки питания из реального компьютера без
надлежащего выключения. Если вы снова запустите машину после выключения питания
вашей операционной системе придется полностью перезагрузиться и может начаться
длительная проверка ее виртуальных системных дисков. В результате этого обычно
не следует делать, так как это потенциально может привести к потере данных или
несогласованному состоянию гостевой системы на диске.

В качестве исключения, если на вашей виртуальной машине есть какие-либо
моментальные снимки, см. Раздел 1.10, “Моментальные снимки”, вы можете
использовать эту опцию для быстрого восстановления текущего моментального
снимка виртуальной машины. В этом случае выключение компьютера не нарушит его
состояние, но любые изменения, внесенные с момента создания этого снимка,
будут потеряны.

Кнопка "Отменить" в окне диспетчера VirtualBox удаляет сохраненное состояние
виртуальной машины. Это имеет тот же эффект, что и отключение питания, и
применяются те же предупреждения.

________________________________________________________________________________

	1.9. Использование групп виртуальных машин

Группы виртуальных машин позволяют пользователю создавать специальные группы
виртуальных машин, а также управлять ими и выполнять на них функции как
коллективно, так и индивидуально.

Для групп доступны следующие функции:
	Создайте группу с помощью менеджера VirtualBox. Выполните одно из
следующих действий:
		Перетащите одну виртуальную машину поверх другой виртуальной машины.
	
		Выберите несколько виртуальных машин и выберите "Группа" в контекстном
		меню.
	
	Создайте группу и управляйте ею с помощью командной строки. Выполните одно
из следующих действий:
		Создайте группу и назначьте виртуальную машину. Например:
		VBoxManage modifyvm "vm01" --groups "/TestGroup"
		Эта команда создает группу "Тестовая группа" и присоединяет
		виртуальную машину "vm01" к этой группе.
		
		Отсоедините виртуальную машину от группы и удалите группу, если она
		пуста. Например:
		VBoxManage modifyvm "vm01" --groups ""
		Эта команда отсоединяет все группы от виртуальной машины "vm01" и
		удаляет пустую группу.

	Создайте несколько групп. Например:
	VBoxManage modifyvm "vm01" --groups "/TestGroup,/TestGroup2"
	Эта команда создает группы "TestGroup" и "TestGroup2", если они не
	существуют, и присоединяет виртуальную машину "vm01" к ним обоим.

	Создайте вложенные группы, имеющие иерархию групп. Например:
	VBoxManage modifyvm "vm01" --groups "/TestGroup/TestGroup2"
	Эта команда присоединяет виртуальную машину "vm01" к подгруппе
	"TestGroup2" группы "TestGroup".

Ниже приводится краткое описание групповых команд:
Start, Pause, Reset, Close (save state, send shutdown signal, poweroff),
Discard Saved State, Show in File System, Sort.


________________________________________________________________________________

	1.10. Моментальные снимки

С помощью моментальных снимков вы можете сохранить определенное состояние
виртуальной машины для последующего использования. В любое более позднее время
вы можете вернуться в это состояние, даже если с тех пор вы, возможно,
значительно изменили виртуальную машину. Таким образом, снимок виртуальной
машины похож на машину в сохраненном состоянии, но их может быть много, и эти
сохраненные состояниясохраняются.

Чтобы просмотреть моментальные снимки виртуальной машины, нажмите на имя
машины в диспетчере виртуальных ящиков. Затем щелкните значок списка рядом с
именем машины и выберите Моментальные снимки. Пока вы не сделаете снимок
машины, список снимков будет пустым, за исключением элемента текущего
состояния, который представляет точку "сейчас" в течение всего срока службы
виртуальной машины.

	1.10.1. Создание, восстановление и Удаление моментальных снимков

Существует три операции, связанные со снимками, а именно:

1. Сделайте снимок. Это создает копию текущего состояния машины, к которому вы
можете вернуться в любой момент времени позже.
Если ваша виртуальная машина запущена, выберите "Сделать снимок" в
раскрывающемся меню "Машина" окна виртуальной машины.
Если ваша виртуальная машина находится в сохраненном или выключенном состоянии,
как показано рядом с именем виртуальной машины в главном окне Oracle VM
VirtualBox, щелкните значок списка рядом с именем машины и выберите
Моментальные снимки.
Откроется окно "Снимки". Выполните одно из следующих действий:

	1. Нажмите на значок "Take".
	2. Щелкните правой кнопкой мыши на элементе текущего состояния в списке
	и выберите Принять.

В любом случае появится окно с запросом на имя снимка. Это имя предназначено
исключительно для справочных целей, чтобы помочь вам запомнить состояние
моментального снимка. Например, полезным именем может быть "Новая установка с
нуля, без добавления гостей" или "Только что установленный пакет обновления 3".
Вы также можете добавить более длинный текст в поле Описание.
Затем ваш новый снимок появится в списке снимков. Под вашим новым снимком вы
увидите элемент под названием Текущее состояние, означающий, что текущее
состояние вашей виртуальной машины является вариантом, основанным на снимке,
который вы сделали ранее. Если позже вы сделаете еще один снимок, вы увидите,
что они отображаются последовательно и что каждый последующий снимок является
производным от предыдущего.
Oracle VM VirtualBox не накладывает ограничений на количество снимков, которые
вы можете сделать. Единственное практическое ограничение-это дисковое
пространство на вашем хосте. Каждый снимок хранит состояние виртуальной машины
и, таким образом, занимает некоторое место на диске. См. Раздел 1.10.2,
“Содержимое моментального снимка” для получения подробной информации о том,
что хранится в моментальном снимке.

2. Восстановите моментальный снимок.
В списке снимков щелкните правой кнопкой мыши на любом сделанном снимке и
выберите Восстановить Восстанавливая моментальный снимок, вы перемещаетесь
назад или вперед во времени. Текущее состояние машины теряется, и машина
восстанавливается в том же состоянии, в котором она находилась во время
создания моментального снимка.

Примечание
Восстановление моментального снимка повлияет на виртуальные жесткие диски,
подключенные к вашей виртуальной машине, так как также будет изменено все
состояние виртуального жесткого диска. Это также означает, что все файлы,
созданные после моментального снимка, и все другие изменения файлов будут
потеряны. Чтобы предотвратить такую потерю данных, все еще используя функцию
моментального снимка, можно добавить второй жесткий диск в режиме сквозной
записи с помощью интерфейса VBoxManage и использовать его для хранения ваших
данных. Поскольку жесткие диски с возможностью записи не включены в
моментальные снимки, они остаются неизменными при возврате машины.
См. Раздел 5.4, “Специальные режимы записи изображений”.

Чтобы избежать потери текущего состояния при восстановлении моментального
снимка, вы можете создать новый моментальный снимок перед операцией
восстановления. Восстановив более ранний снимок и сделав оттуда больше
снимков, можно даже создать своего рода альтернативную реальность и
переключаться между этими различными историями виртуальной машины. Это может
привести к созданию целого дерева снимков виртуальной машины, как показано на
скриншоте выше.

3. Удалите снимок.
Это не влияет на состояние виртуальной машины, а только
освобождает файлы на диске, которые Oracle VM VirtualBox использовала для
хранения данных моментальных снимков, освобождая таким образом место на диске.
Чтобы удалить снимок, щелкните правой кнопкой мыши имя снимка в дереве снимков
и выберите Удалить.
Моментальные снимки могут быть удалены даже во время работы компьютера.

Примечание
В то время как создание и восстановление моментальных снимков являются
довольно быстрыми операциями, удаление моментального снимка может занять
значительное время, поскольку может потребоваться копирование больших объемов
данных между несколькими файлами образов дисков. Временным дисковым файлам
также может потребоваться большой объем дискового пространства во время
выполнения операции.

Существуют некоторые ситуации, которые невозможно обработать во время работы
виртуальной машины, и вы получите соответствующее сообщение о том, что вам
необходимо выполнить удаление этого снимка при выключении виртуальной машины.

	1.10.2. Содержимое моментального снимка

Думайте о моментальном снимке как о точке во времени, которую вы сохранили.
Более формально снимок состоит из следующего:

* Снимок содержит полную копию параметров виртуальной машины, включая
конфигурацию оборудования, поэтому при восстановлении снимка параметры
виртуальной машины также восстанавливаются. Например, если вы изменили
конфигурацию жесткого диска или системные настройки виртуальной машины, это
изменение будет отменено при восстановлении моментального снимка.
Копия настроек хранится в конфигурации компьютера в виде текстового XML-файла и,
таким образом, занимает очень мало места.

* Полное состояние всех виртуальных дисков, подключенных к машине, сохраняется.
Возврат к моментальному снимку означает, что все изменения, внесенные на диски
машины, файл за файлом и по частям, также будут отменены. Файлы, которые были
созданы с тех пор, исчезнут, удаленные файлы будут восстановлены, изменения в
файлах будут отменены.
Строго говоря, это справедливо только для виртуальных жестких дисков в "обычном"
режиме. Вы можете настроить диски таким образом, чтобы они вели себя по-разному
с моментальными снимками, см. Раздел 5.4, “Специальные режимы записи образов”.
С технической точки зрения, при восстановлении моментального снимка
восстанавливается не сам виртуальный диск. Вместо этого при создании
моментального снимка Oracle VM VirtualBox создает изображения различий,
которые содержат только изменения, внесенные с момента создания моментального
снимка. Когда снимок восстановлен, Oracle VM VirtualBox отбрасывает это
различающееся изображение, возвращаясь таким образом в предыдущее состояние.
Это одновременно быстрее и занимает меньше места на диске.
Подробные сведения, которые могут быть сложными, см. в разделе
5.5" Различение изображений”.
Создание образа разности как такового изначально не занимает много места на
диске хоста, так как образ разности изначально будет пустым и будет динамически
увеличиваться с каждой операцией записи на диск. Однако чем дольше вы
используете устройство после создания моментального снимка, тем больше будет
увеличиваться размер отличающегося изображения.

* Если вы сделали снимок во время работы машины, состояние памяти машины также
сохраняется в моментальном снимке. Это происходит таким же образом, что память
может быть сохранена при закрытии окна виртуальной машины. При восстановлении
такого снимка выполнение возобновляется точно в тот момент, когда был сделан
снимок.
Файл состояния памяти может быть размером с объем памяти виртуальной машины и,
следовательно, занимать значительное место на диске.

________________________________________________________________________________

				Глава 6. Виртуальная сеть содержание

6.1. Оборудование Виртуальной Сети
6.2. Введение в сетевые режимы
6.3. Преобразование сетевых адресов (NAT)
	6.3.1. Настройка переадресации портов с помощью NAT
	6.3.2. Загрузка PXE с помощью NAT
	6.3.3. Ограничения NAT
	6.4. Служба Перевода Сетевых Адресов
6.5. Мостовая сеть
6.6. Внутренняя сеть
6.7. Сеть только для Хостов
6.8. Сеть туннелей UDP
6.9. Сеть VDE
6.10. Ограничение пропускной способности для сетевого ввода/вывода
6.11. Повышение Производительности Сети

Как упоминалось в разделе 3.9 “Сетевые настройки”, Oracle VM VirtualBox
предоставляет до восьми виртуальных карт PCI Ethernet для каждой виртуальной
машины. Для каждой такой карты вы можете индивидуально выбрать следующие:
	* Аппаратное обеспечение, которое будет виртуализировано.
	* Режим виртуализации, в котором работает виртуальная карта, по отношению
	к вашему физическому сетевому оборудованию на хосте.

Четыре сетевые карты можно настроить в разделе "Сеть" диалогового окна
"Настройки" в графическом пользовательском интерфейсе Oracle VM VirtualBox. Вы
можете настроить все восемь сетевых карт в командной строке с помощью
VBoxManage modifyvm. См. Раздел 8.8, “VBoxManage modifyvm”.

В этой главе более подробно описываются различные сетевые настройки.

________________________________________________________________________________

	6.1. Оборудование Виртуальной Сети

Для каждой карты вы можете индивидуально выбрать, какое оборудование будет
представлено виртуальной машине. Oracle VM VirtualBox может виртуализировать
следующие типы сетевого оборудования:

	* AMD PCNet PCI II (Am79C970A)
	* AMD PCNet FAST III (Am79C973), the default setting
	* Intel PRO/1000 MT Desktop (82540EM)
	* Intel PRO/1000 T Server (82543GC)
	* Intel PRO/1000 MT Server (82545EM)
	* Paravirtualized network adapter (virtio-net)

PCnet FAST III используется по умолчанию, поскольку он поддерживается почти
всеми операционными системами, а также менеджером загрузки GNU GRUB. В качестве
исключения адаптеры семейства Intel PRO/1000 выбраны для некоторых типов
гостевых операционных систем, которые больше не поставляются с драйверами для
карты PCnet, например Windows Vista.

Intel PRO/1000 MT Desktop PRO/1000 работает с Windows Vista и более поздними
версиями. Серверный вариант карты Intel PRO/1000 T распознается гостями Windows
XP без дополнительной установки драйверов. Вариант сервера MT облегчает импорт
OVF с других платформ.

Паравиртуализированный сетевой адаптер (virtio-net) является особенным. Если
вы выберете этот адаптер, то Oracle VM VirtualBox не виртуализирует общее
сетевое оборудование, поддерживаемое общими гостевыми операционными системами.
Вместо этого Oracle VM VirtualBox ожидает, что гость предоставит специальный
программный интерфейс для виртуализированных сред, что позволит избежать
сложностей эмуляции сетевого оборудования и повысить производительность сети.
Oracle VM VirtualBox обеспечивает поддержку стандартных сетевых драйверов
virtio, которые являются частью проекта KVM с открытым исходным кодом.

Сетевые драйверы virtio доступны для следующих гостевых операционных систем:
	* Ядра Linux версии 2.6.25 или более поздней могут быть настроены для
	обеспечения поддержки virtio. Некоторые дистрибутивы также перенесли
	virtio на более старые ядра.
	* Для Windows 2000, XP и Vista драйверы virtio можно загрузить и установить
	с веб-страницы проекта KVM:
	http://www.linux-kvm.org/page/WindowsGuestDrivers.

Oracle VM VirtualBox также имеет ограниченную поддержку jumbo frames. Это
сетевые пакеты с более чем 1500 байтами данных при условии, что вы используете
виртуализацию карт Intel и подключенную сеть. jumbo framesне поддерживаются
сетевыми устройствами AMD. В этих случаях пакеты jumbo будут автоматически
отбрасываться как для направления передачи, так и для направления приема.
Гостевые операционные системы, пытающиеся использовать эту функцию, будут
рассматривать это как потерю пакетов, что может привести к неожиданному
поведению приложения в гостевой системе. Это не вызывает проблем с гостевыми
операционными системами в их конфигурации по умолчанию, так как большие рамки
должны быть явно включены.

________________________________________________________________________________


	6.2. Введение в сетевые режимы

Каждый из сетевых адаптеров может быть отдельно настроен для работы в одном из
следующих режимов:

	* Не привязан (Not attached). В этом режиме Oracle VM VirtualBox сообщает
гостю о наличии сетевой карты, но об отсутствии подключения. Это похоже на то,
как если бы к карте не был подключен кабель Ethernet. Используя этот режим,
можно вытащить виртуальный кабель Ethernet и прервать соединение, что может
быть полезно для информирования гостевой операционной системы об отсутствии
сетевого подключения и принудительной перенастройки.

	* Преобразование сетевых адресов (NAT). Если все, что вам нужно, - это
просматривать веб-страницы, загружать файлы и просматривать электронную почту
внутри гостя, то этого режима по умолчанию должно быть достаточно для вас,
и вы можете пропустить остальную часть этого раздела. Пожалуйста, обратите
внимание, что при использовании общего доступа к файлам Windows существуют
определенные ограничения. См. Раздел 6.3.3, “Ограничения NAT”.

	* Сеть NAT. Сеть NAT-это тип внутренней сети, которая позволяет
осуществлять исходящие соединения. См. Раздел 6.4, “Служба Перевода Сетевых
Адресов”.

	* Объединенная сеть (bridged networking). Это предназначено для более
сложных сетевых задач, таких как моделирование сети и запуск серверов в
гостевой системе. При включении Oracle VM VirtualBox подключается к одной из
установленных сетевых карт и напрямую обменивается сетевыми пакетами, обходя
сетевой стек операционной системы хоста.
	
	* Внутренняя сеть (internal networking). Это может быть использовано для
создания другого вида программной сети, которая видна выбранным виртуальным
машинам, но не приложениям, запущенным на хосте, или внешнему миру.

	* Сеть только для хоста (host-only networking). Это может быть использовано
для создания сети, содержащей хост и набор виртуальных машин, без необходимости
в физическом сетевом интерфейсе хоста. Вместо этого на хосте создается
виртуальный сетевой интерфейс, аналогичный интерфейсу обратной связи,
обеспечивающий связь между виртуальными машинами и хостом.

	* Общая сеть (generic networking). Редко используемые режимы, которые
используют один и тот же общий сетевой интерфейс, позволяя пользователю
выбирать драйвер, который может быть включен в Oracle VM VirtualBox или
распространяться в пакете расширений.
Доступны следующие подрежимы:
		* Туннель UDP: Используется для прямого, простого и прозрачного
		подключения виртуальных машин, работающих на разных хостах, через
		существующую сетевую инфраструктуру.
		* Сеть VDE (Virtual Distributed Ethernet): Используется для
		подключения к виртуальному распределенному коммутатору Ethernet на
		хосте Linux или FreeBSD. На данный момент эта опция требует компиляции
		Oracle VM VirtualBox из исходных текстов, так как пакеты Oracle ее не
		включают.

В следующей таблице представлен обзор наиболее важных сетевых режимов.

Mode		VM->Host  VM<-Host  VM1<->VM2  VM->Net/LAN  VM<-Net/LAN

Host-only	   +		+		 	+			-			-			

Internal	   -		-			+			-			-	   

Bridged		   +        +           +           +           +

NAT            +       port forw    -           +          port forw

NATservice     +       port forw    +           +          port forw

________________________________________________________________________________


	6.3. Преобразование сетевых адресов (NAT)

Преобразование сетевых адресов (NAT) - это самый простой способ доступа к
внешней сети с виртуальной машины. Обычно это не требует какой-либо настройки
в сети хоста и гостевой системе. По этой причине это сетевой режим по умолчанию
в Oracle VM VirtualBox.

Виртуальная машина с включенным NAT действует во многом как реальный компьютер,
который подключается к Интернету через маршрутизатор. Маршрутизатором в данном
случае является сетевой движок Oracle VM VirtualBox, который прозрачно
отображает трафик с виртуальной машины и на нее. В Oracle VM VirtualBox этот
маршрутизатор размещается между каждой виртуальной машиной и хостом. Это
разделение обеспечивает максимальную безопасность, поскольку по умолчанию
виртуальные машины не могут общаться друг с другом.

Недостатком режима NAT является то, что, подобно частной сети за
маршрутизатором, виртуальная машина невидима и недоступна из внешнего
Интернета. Вы не сможете запустить сервер таким образом, если не настроите
переадресацию портов. См. Раздел 6.3.1, “Настройка переадресации портов с
помощью NAT”.

Сетевые кадры, отправляемые гостевой операционной системой, принимаются
механизмом NAT Oracle VM VirtualBox, который извлекает данные TCP/IP и повторно
отправляет их с помощью операционной системы хоста. В приложение на хосте или
на другой компьютер в той же сети, что и хост, похоже, что данные были
отправлены приложением Oracle VM VirtualBox на хосте с использованием
IP-адреса, принадлежащего хосту. Oracle VM VirtualBox прослушивает ответы на
отправленные пакеты, переупаковывает и повторно отправляет их на гостевой
компьютер в своей частной сети.

Примечание
Несмотря на то, что механизм NAT отделяет виртуальную машину от хоста,
виртуальная машина имеет доступ к интерфейсу обратной связи хоста и сетевым
службам, работающим на нем. Интерфейс обратной связи хоста доступен по
IP-адресу 10.0.2.2. Этот доступ к интерфейсу обратной связи хоста может быть
чрезвычайно полезен в некоторых случаях, например, при запуске разрабатываемого
веб-приложения на виртуальной машине и сервере базы данных в интерфейсе
обратной связи на хосте.

Виртуальная машина получает свой сетевой адрес и конфигурацию в частной сети от
DHCP-сервера, интегрированного в Oracle VM VirtualBox. IP-адрес, назначенный
таким образом виртуальной машине, обычно находится в совершенно другой сети,
чем хост. Поскольку для использования NAT можно настроить несколько карт
виртуальной машины, первая карта подключена к частной сети 10.0.2.0, вторая
карта-к сети 10.0.3.0 и так далее. Если вам необходимо изменить диапазон
IP-адресов, назначенных гостем, см. Раздел 9.8 “Точная настройка NAT-модуля
Oracle VM VirtualBox”.

	6.3.1. Настройка переадресации портов с помощью NAT

Поскольку виртуальная машина подключена к частной сети, внутренней для Oracle
VM VirtualBox и невидимой для хоста, сетевые службы на гостевой машине
недоступны для хост-машины или других компьютеров в той же сети. Однако, как и
физический маршрутизатор, Oracle VM VirtualBox может сделать выбранные службы
доступными для внешнего мира с помощью переадресации портов. Это означает, что
Oracle VM VirtualBox прослушивает определенные порты на хосте и повторно
отправляет все пакеты, поступающие туда, гостю на тот же или другой порт.

Для приложения на хосте или других физических или виртуальных машинах в сети
это выглядит так, как будто проксируемая служба фактически запущена на хосте.
Это также означает, что вы не можете запускать одну и ту же службу на одних и
тех же портах на хосте. Однако вы все равно получаете преимущества запуска
службы на виртуальной машине. Например, службы на главной машине или на других
виртуальных машинах не могут быть скомпрометированы или выведены из строя из-за
уязвимости или ошибки в службе, и служба может работать в операционной
системе, отличной от основной системы.

Для настройки переадресации портов вы можете использовать графический редактор
переадресации портов, который можно найти в диалоговом окне Настройки сети для
сетевых адаптеров, настроенных для использования NAT. Здесь вы можете
сопоставить порты хоста с гостевыми портами, чтобы разрешить маршрутизацию
сетевого трафика на определенный порт в гостевой системе.

В качестве альтернативы можно использовать инструмент командной строки
VBoxManage. См. Раздел 8.8, “VBoxManage modifyvm”.

Вам нужно будет знать, какие порты на гостевой системе использует служба, и
решить, какие порты использовать на хосте. Возможно, вам захочется использовать
одни и те же порты на гостевой и на хосте. Вы можете использовать любые порты
на хосте, которые еще не используются службой. Например, чтобы настроить
входящие подключения NAT к ssh-серверу в гостевой системе, используйте
следующую команду:

	VBoxManage modifyvm "VM name" --natpf1 "guestssh,tcp,,2222,,22"

В приведенном выше примере весь TCP-трафик, поступающий на порт 2222 любого
интерфейса хоста, будет перенаправляться на порт 22 в гостевой системе. Имя
протокола tcp является обязательным атрибутом, определяющим, какой протокол
следует использовать для пересылки, также может использоваться udp. Имя
guestssh является чисто описательным и будет автоматически сгенерировано, если
оно будет опущено. Число после --natpf обозначает сетевую карту, как и в
случае с другими командами управления VBoxManage.

Чтобы удалить это правило пересылки, используйте следующую команду:
	
	VBoxManage modifyvm "VM name" --natpf1 delete "guestssh"

Если по какой-либо причине гость использует статический назначенный IP-адрес,
не арендованный у встроенного DHCP-сервера, при регистрации правила пересылки
необходимо указать гостевой IP-адрес следующим образом:

	VBoxManage modifyvm "VM name" --natpf1 "guestssh,tcp,,2222,10.0.2.19,22"

Этот пример идентичен предыдущему, за исключением того, что механизму NAT
сообщается, что гостя можно найти по адресу 10.0.2.19.

Чтобы перенаправить весь входящий трафик с определенного хост-интерфейса на
гостевой, укажите IP-адрес этого хост-интерфейса следующим образом:
	
	VBoxManage modifyvm "VM name" --natpf1 "guestssh,tcp,127.0.0.1,2222,,22"

В этом примере весь TCP-трафик, поступающий на интерфейс localhost в 127.0.0.1,
перенаправляется через порт 2222 на порт 22 в гостевой системе.

Можно настроить входящие подключения NAT во время работы виртуальной машины,
см. Раздел 8.13, “VBoxManage controlvm”.

	6.3.2. Загрузка PXE с помощью NAT

Загрузка PXE теперь поддерживается в режиме NAT. DHCP-сервер NAT предоставляет
имя загрузочного файла в виде vmname.pxe, если каталог TFTP существует в
каталоге, в котором находится VirtualBox.xml файл хранится. Пользователь несет
ответственность за предоставление vmname.pxe.

	6.3.3. Ограничения NAT

Существуют некоторые ограничения режима NAT, о которых пользователи должны
знать, а именно::

* Ограничения протокола ICMP. Некоторые часто используемые инструменты отладки
сети, такие как ping или трассировка маршрута, полагаются на протокол ICMP для
отправки и получения сообщений. Поддержка ICMP Oracle VM VirtualBox имеет
некоторые ограничения, что означает, что ping должен работать, но некоторые
другие инструменты могут работать ненадежно.

* Прием UDP broadcast. Гость не может надежно получать передачи UDP. В целях
экономии ресурсов он прослушивает только определенное количество времени после
того, как гость отправил данные UDP на определенный порт. Как следствие,
разрешение имен NetBIOS на основе широковещательных сообщений не всегда
работает, но WINS всегда работает. В качестве обходного пути вы можете
использовать числовой IP-адрес нужного сервера в обозначении \\\server\share

* Некоторые протоколы не поддерживаются. Протоколы, отличные от TCP и UDP, не
поддерживаются. GRE не поддерживается. Это означает, что некоторые продукты
VPN, такие как PPTP от Microsoft, не могут быть использованы. Существуют и
другие продукты VPN, которые используют только TCP и UDP.

* Перенаправление портов хоста ниже 1024. На хостах на базе UNIX, таких как
Linux, Oracle Solaris и Mac OS X, невозможно выполнить привязку к портам ниже
1024 из приложений, не запущенных root. В результате, если вы попытаетесь
настроить такую переадресацию портов, виртуальная машина откажется запускаться.

Эти ограничения обычно не влияют на стандартное использование сети. Но наличие
NAT также имеет тонкие эффекты, которые могут мешать нормально работающим
протоколам. Одним из примеров является NFS, где сервер часто настроен на отказ
от соединений с непривилегированными портами, которые являются портами не ниже
1024.

________________________________________________________________________________


	6.4. Служба Перевода Сетевых Адресов
		 Network Address Translation Service

Служба преобразования сетевых адресов (NAT) работает аналогично домашнему
маршрутизатору, группируя системы, использующие ее, в сеть и предотвращая
прямой доступ систем за пределами этой сети к системам внутри нее, но позволяя
системам внутри взаимодействовать друг с другом и с системами снаружи,
используя TCP и UDP по IPv4 и IPv6.

Служба NAT подключена к внутренней сети. Виртуальные машины, которые должны
его использовать, должны быть подключены к этой внутренней сети. Имя внутренней
сети выбирается при создании службы NAT, и внутренняя сеть будет создана, если
она еще не существует. Ниже приведен пример команды для создания сети NAT:

	VBoxManage natnetwork add --netname natnet1 --network "192.168.15.0/24"
												--enable

Здесь natnet1-это имя используемой внутренней сети, а 192.168.15.0/24-сетевой
адрес и маска интерфейса службы NAT. По умолчанию в этой статической
конфигурации шлюзу будет присвоен адрес 192.168.15.1, адрес, следующий за
адресом интерфейса, хотя он может быть изменен. Чтобы подключить DHCP-сервер к
внутренней сети, измените команду примера следующим образом:

	VBoxManage natnetwork add --netname natnet1 --network "192.168.15.0/24"
							  --enable --dhcp on

Чтобы добавить DHCP-сервер в существующую сеть, используйте следующую команду:

	VBoxManage natnetwork modify --netname natnet1 --dhcp on

Чтобы отключить DHCP-сервер, используйте следующую команду:

	VBoxManage natnetwork modify --netname natnet1 --dhcp off

DHCP-сервер предоставляет список зарегистрированных серверов имен, но не
сопоставляет серверы из сети 127/8.

Чтобы запустить службу NAT, используйте следующую команду:

	VBoxManage natnetwork start --netname natnet1

Если к сети подключен DHCP-сервер, то он запустится вместе с сетевой службой
NAT.

Чтобы остановить сетевую службу NAT вместе с любым DHCP-сервером:

	VBoxManage natnetwork stop --netname natnet1

Чтобы удалить сетевую службу NAT:

	VBoxManage natnetwork remove --netname natnet1

Эта команда не удаляет DHCP-сервер, если он включен во внутренней сети.

Поддерживается переадресация портов с использованием переключателя
--port-forward-4 для IPv4 и --port-forward-6 для IPv6. Например:

	VBoxManage natnetwork modify \
  	--netname natnet1 --port-forward-4 "ssh:tcp:[]:1022:[192.168.15.5]:22"

Это добавляет правило переадресации портов с порта TCP 1022 хоста на порт 22
гостя с IP-адресом 192.168.15.5. Порт хоста, гостевой порт и гостевой IP
являются обязательными. Чтобы удалить правило, используйте следующую команду:

	VBoxManage natnetwork modify --netname natnet1 --port-forward-4 delete ssh

Можно привязать службу NAT к указанному интерфейсу. Например:

	VBoxManage setextradata global "NAT/win-nat-test-0/SourceIp4" 192.168.1.185

Чтобы просмотреть список зарегистрированных сетей NAT, используйте следующую
команду:

	VBoxManage list natnetworks

Сети NAT также можно создавать, удалять и настраивать с помощью диспетчера
VirtualBox. Нажмите Файл, Настройки и выберите страницу Сети.

Примечание
Несмотря на то, что служба NAT отделяет виртуальную машину от хоста,
виртуальная машина имеет доступ к интерфейсу обратной связи хоста и сетевым
службам, работающим на нем. Интерфейс обратной связи хоста доступен как
IP-адрес 10.0.2.2 (при условии, что конфигурация по умолчанию, в других
конфигурациях это соответствующий адрес в настроенном сетевом диапазоне IPv4
или IPv6). Этот доступ к интерфейсу обратной связи хоста может быть
чрезвычайно полезен в некоторых случаях, например, при запуске
разрабатываемого веб-приложения в виртуальной машине и сервера базы данных в
интерфейсе обратной связи хоста.

________________________________________________________________________________

	6.5. Bridged Networking

При использовании мостовой сети Oracle VM VirtualBox использует драйвер
устройства в вашей хост-системе, который фильтрует данные с вашего физического
сетевого адаптера. Поэтому этот драйвер называется драйвером сетевого фильтра.
Это позволяет Oracle VM VirtualBox перехватывать данные из физической сети и
вводить в нее данные, эффективно создавая новый сетевой интерфейс в
программном обеспечении. Когда гость использует такой новый программный
интерфейс, для хост-системы это выглядит так, как если бы гость был физически
подключен к интерфейсу с помощью сетевого кабеля. Хост может отправлять данные
гостю через этот интерфейс и получать данные от него. Это означает, что вы
можете настроить маршрутизацию или соединение между гостем и остальной частью
вашей сети.

Примечание
Даже несмотря на то, что интерфейсы TAP больше не нужны в Linux для мостовой
сети, вы все равно можете использовать интерфейсы TAP для определенных
расширенных настроек, поскольку вы можете подключить виртуальную машину к
любому интерфейсу хоста.

Чтобы включить мостовую сеть, откройте диалоговое окно параметров виртуальной
машины, перейдите на страницу Сеть и выберите Мостовую сеть в раскрывающемся
списке для поля "Подключено". Выберите интерфейс хоста из списка внизу
страницы, который содержит физические сетевые интерфейсы ваших систем.
Например, на типичном MacBook это позволит вам выбрать между en1: AirPort,
который является беспроводным интерфейсом, и en0: Ethernet, который
представляет интерфейс с сетевым кабелем.

Примечание
Подключение к беспроводному интерфейсу выполняется иначе, чем подключение к
проводному интерфейсу, поскольку большинство беспроводных адаптеров не
поддерживают беспорядочный режим. Весь трафик должен использовать MAC-адрес
беспроводного адаптера хоста, и поэтому Oracle VM VirtualBox необходимо
заменить исходный MAC-адрес в заголовке Ethernet исходящего пакета, чтобы
убедиться, что ответ будет отправлен в интерфейс хоста. Когда Oracle VM
VirtualBox видит входящий пакет с IP-адресом назначения, принадлежащим одному
из адаптеров виртуальной машины, он заменяет MAC-адрес назначения в заголовке
Ethernet MAC-адресом адаптера виртуальной машины и передает его. Oracle VM
VirtualBox проверяет пакеты ARP и DHCP, чтобы узнать IP-адреса виртуальных
машин.

В зависимости от операционной системы вашего хоста применяются следующие
ограничения:

* Хосты Mac OS X. Функциональные возможности ограничены при использовании
AirPort, беспроводной сетевой системы Mac, для подключенных сетей. В настоящее
время Oracle VM VirtualBox поддерживает только IPv4 и IPv6 через аэропорт. Для
других протоколов, таких как IPX, необходимо выбрать проводной интерфейс.

* Хосты Linux. Функциональные возможности ограничены при использовании
беспроводных интерфейсов для мостовой сети. В настоящее время Oracle VM
VirtualBox поддерживает только IPv4 и IPv6 по беспроводной сети. Для других
протоколов, таких как IPX, необходимо выбрать проводной интерфейс.
Кроме того, известно, что установка MTU менее 1500 байт на проводных
интерфейсах, предоставляемых драйвером sky2 сетевой карты Marvell Yukon II EC
Ultra Ethernet, при определенных условиях может привести к потере пакетов.
Некоторые адаптеры удаляют теги VLAN в аппаратном обеспечении. Это не позволяет
использовать транкинг VLAN между виртуальной машиной и внешней сетью с ядрами
Linux до версии 2.6.27 или с хост-операционными системами, отличными от Linux.

* Хосты Oracle Solaris. Нет поддержки использования беспроводных интерфейсов.
Фильтрация гостевого трафика с помощью IPFilter также не поддерживается
полностью из-за технических ограничений сетевой подсистемы Oracle Solaris.
Эти проблемы могут быть устранены в более поздних версиях Oracle Solaris 11.

На хостах Oracle Solaris 11 сборки 159 и выше можно использовать виртуальные
сетевые интерфейсы Oracle Solaris Crossbow (VNIC) напрямую с Oracle VM
VirtualBox без каких-либо дополнительных настроек, кроме того, что каждый VNIC
должен быть эксклюзивным для каждого гостевого сетевого интерфейса.

При использовании интерфейсов VLAN с Oracle VM VirtualBox они должны быть
названы в соответствии со схемой именования PPA-hack, такой как e1000g513001.
В противном случае гость может получать пакеты в неожиданном формате.

________________________________________________________________________________

	6.6. Внутренняя сеть

Внутренняя сеть похожа на мостовую сеть в том смысле, что виртуальная машина
может напрямую взаимодействовать с внешним миром. Однако внешний мир ограничен
другими виртуальными машинами на том же хосте, которые подключаются к той же
внутренней сети.

Несмотря на то, что технически все, что может быть сделано с использованием
внутренней сети, также может быть сделано с использованием мостовой сети, у
внутренней сети есть преимущества в плане безопасности. В режиме мостовой сети
весь трафик проходит через физический интерфейс хост-системы. Поэтому можно
подключить анализатор пакетов, такой как Wireshark, к интерфейсу хоста и
регистрировать весь трафик, проходящий через него. Если по какой-либо причине
вы предпочитаете, чтобы две или более виртуальных машины на одной машине
общались конфиденциально, скрывая свои данные как от хост-системы, так и от
пользователя, поэтому мостовая сеть не является вариантом.

Внутренние сети создаются автоматически по мере необходимости. Центральной
конфигурации не существует. Каждая внутренняя сеть идентифицируется просто по
ее названию. Как только появится более одной активной виртуальной сетевой карты
с одинаковым идентификатором внутренней сети, драйвер поддержки Oracle VM
VirtualBox автоматически подключит карты и будет действовать как сетевой
коммутатор. Драйвер поддержки Oracle VM VirtualBox реализует полный коммутатор
Ethernet и поддерживает как широковещательные/многоадресные кадры, так и
беспорядочный режим.

Чтобы подключить сетевую карту виртуальной машины к внутренней сети, установите
ее сетевой режим на Внутреннюю сеть. Для этого есть два способа:

* Используйте диалоговое окно настроек виртуальной машины в диспетчере
виртуальных ящиков. В категории "Сеть" диалогового окна "Настройки" выберите
"Внутренняя сеть" из раскрывающегося списка сетевых режимов. Выберите имя
существующей внутренней сети из раскрывающегося списка ниже или введите новое
имя в поле Имя.

* Используйте командную строку, например:

	VBoxManage modifyvm "VM name" --nic<x> intnet

При необходимости вы можете указать сетевое имя с помощью команды:

	VBoxManage modifyvm "VM name" --intnet<x> "network name"

Если вы не укажете сетевое имя, сетевая карта по умолчанию будет подключена к
сети intnet.

Если вы не настроили виртуальные сетевые карты в гостевых операционных
системах, участвующих во внутренней сети, для использования статических
IP-адресов, вы можете использовать DHCP-сервер, встроенный в Oracle VM
VirtualBox, для управления IP-адресами для внутренней сети.
См. Раздел 8.42, “VBoxManage dhcpserver”.

В качестве меры безопасности по умолчанию реализация внутренней сети Linux
позволяет виртуальным машинам, работающим под одним и тем же идентификатором
пользователя, устанавливать внутреннюю сеть только по умолчанию. Однако можно
создать общий внутренний сетевой интерфейс, доступный пользователям с разными
идентификаторами пользователей.

________________________________________________________________________________

	6.7. Сеть только для Хостов

Сеть только для хоста можно рассматривать как гибрид между мостовым и
внутренним сетевым режимами. Как и в случае с мостовой сетью, виртуальные
машины могут общаться друг с другом и с хостом, как если бы они были подключены
через физический коммутатор Ethernet. Как и во внутренней сети, физический
сетевой интерфейс не обязательно должен присутствовать, и виртуальные машины
не могут общаться с внешним миром, поскольку они не подключены к физическому
сетевому интерфейсу.

Когда используется сеть только для хоста, Oracle VM VirtualBox создает новый
программный интерфейс на хосте, который затем отображается рядом с
существующими сетевыми интерфейсами. Другими словами, в то время как в
мостовой сети для подключения виртуальных машин используется существующий
физический интерфейс, в сети только для хоста на хосте создается новый
интерфейс обратной связи. И в то время как во внутренней сети трафик между
виртуальными машинами не виден, трафик в интерфейсе обратной связи на хосте
может быть перехвачен.

Сеть только для хоста особенно полезна для предварительно настроенных
виртуальных устройств, где несколько виртуальных машин поставляются вместе и
предназначены для совместной работы. Например, одна виртуальная машина может
содержать веб-сервер, а вторая-базу данных, и, поскольку они предназначены для
взаимодействия друг с другом, устройство может дать указание Oracle
VM VirtualBox настроить сеть только для хостов для этих двух. Вторая,
соединенная мостом, сеть затем соединит веб-сервер с внешним миром для передачи
данных, но внешний мир не может подключиться к базе данных.

Чтобы включить сетевой интерфейс только для хоста для виртуальной машины,
выполните одно из следующих действий:

* Перейдите на страницу "Сеть" в диалоговом окне "Параметры виртуальной машины"
и выберите вкладку "Адаптер". Убедитесь, что установлен флажок Включить
сетевой адаптер, и в поле Подключено выберите Адаптер только для хоста.

* В командной строке используйте:
	VBoxManage modifyvm "vmname --nicx hostonly
См. Раздел 8.8, “VBoxManage modifyvm”.

Для сетей только для хостов, как и для внутренних сетей, может оказаться
полезным DHCP-сервер, встроенный в Oracle VM VirtualBox. Это включено по
умолчанию и управляет IP-адресами в сети только для хостов. Без DHCP-сервера
вам пришлось бы статически настраивать все IP-адреса.

В диспетчере VirtualBox вы можете настроить DHCP-сервер, выбрав Файл,
Диспетчер сети хоста. Диспетчер сети хоста перечисляет все сети только для
хоста, которые в настоящее время используются. Выберите сетевое имя, а затем
используйте вкладку DHCP - сервер для настройки параметров DHCP-сервера.

В качестве альтернативы вы можете использовать команду
	VBoxManage dhcpserver
 См. Раздел 8.42, “VBoxManage dhcpserver”.

Примечание
На хостах Linux и Mac OS X количество интерфейсов только для хоста ограничено
128. Для хостов Oracle Solaris и Windows такого ограничения нет.

________________________________________________________________________________




________________________________________________________________________________
